{
 "_liked_by": "[\"Administrator\"]",
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2021-08-11 22:16:48.363991",
 "css": ".column_ {\n    display: flex;\n    flex-direction: column\n}\n\n.row_ > div.column_ {\n  flex:1;\n  max-width:100%;\n  max-height:100%;\n}\n\ndiv.text-left-header {\n    font-size: small;\n}\n\n.row_ {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between\n}\n\n#head {\n    display: flex;\n    justify-content: space-between;\n}\n\n.label_ {\n    font-weight: bold;\n}\n\n.b_label {\n    font-size: 12px;\n}\n\n#head-label {\n    background: rgb(0 0 0);\n    color: rgb(255 255 255);\n    font-size: 18px;\n}\n\n.separator {\n    margin-bottom: 1px;\n    border: 0;\n    padding-top: 2px;\n    border-top: 1px solid rgb(0 0 0);\n}\n\ntable td {border-collapse:collapse !important}\n\n.terms {\n    list-style: decimal inside;\n    margin-left: -35px;\n}\n\n.bottom_ {\n    justify-content: space-between;\n}",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "PSOF",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "{% from \"erpnext/templates/includes/macros.html\" import format_nicely %}\r\n{% set bill_view = frappe.db.get_list('PSOF Program Bill', filters={'psof': doc.name , 'customer_name': doc.customer_name }, \r\nfields=['subscription_program', 'date_from', 'sum(subscription_fee) as total_fee', \"sum(no_of_subs) as n_subs\", \"sum(subscription_rate) as s_rate\"], \r\ngroup_by=\"date_from\", order_by=\"date_from asc\") %}\r\n\r\n{% set programs = frappe.db.get_list('PSOF Program', \r\nfilters={'parent': doc.name , 'subscription_contract': doc.subscription_contract }, \r\nfields=['subscription_program']) %}\r\n\r\n{% set contract = {'expiry_date': doc.programs[0].end_date, 'start_date': doc.programs[0].start_date } %}\r\n{% set monthE, dateE, yearE = frappe.format_date(contract.expiry_date).split(\" \") %}\r\n{% set monthS, dateS, yearS = frappe.format_date(contract.start_date).split(\" \") %}\r\n\r\n<div id=\"main-body\" style=\"font-size: small;\" class=\"column_ page-break\">\r\n    <div id=\"head\">\r\n        <div style=\"height: auto;width: 164px;\"><img src=\"/files/cablebosslogo.png\" /></div>\r\n        <div class=\"column_\" style=\"justify-content: space-between\">\r\n            <div class=\"text-center\" >\r\n                <b>CABLE BOX OFFICE SHOWS AND SYSTEMS CORPORATION</b><br>\r\n                6/F Renaissance Tower D, Meralco Avenue, Pasig City<br> \r\n                Tel.: 8633-7361 | 8633-6249 <br>\r\n                Fax: 8633-7354\r\n            </div>\r\n            <div class=\"text-center\" id=\"head-label\">PROGRAM SERVICE ORDER FORM</div>\r\n        </div>\r\n        <div class=\"column_\" style=\"align-self: center\">\r\n            <div class=\"row\">\r\n                <div class=\"col-xs-12 text-center\">\r\n                    <div style=\"white-space:nowrap;\">{{ [monthS  + '.', dateS, yearS] | join(\" \") }}</div>\r\n                    <hr class=\"separator\" style=\"margin-top: 2px;\">\r\n                    <div><b>Date:</b></div>\r\n                </div>\r\n            </div>\r\n            <div style='line-height: 0.8;'>\r\n                <div><span style=\"font-size: 20px;\">{{ \"&#9745;\" if doc.renewal else \"&#9744;\" }}</span> Renewal</div>\r\n                <div><span style=\"font-size: 20px;\">{{ \"&#9745;\" if doc.new_aflt else \"&#9744;\" }}</span> New Affiliate</div>\r\n                <div><span style=\"font-size: 20px;\">{{ \"&#9745;\" if doc.new_program else \"&#9744;\" }}</span> New Program</div>\r\n            </div>\r\n            {% if doc.superseded %}\r\n                <div style=\"font-size: small\">Ammend PSOF# {{ doc.dummy_psof }}</div>\r\n            {% endif %}\r\n        </div>\r\n    </div>\r\n\r\n    <div id=\"table-body\">\r\n        <table border=\"1\" style=\"width: 100%\">\r\n            <tr>\r\n                <td class=\"label_\" colspan=\"1\">Subscribing Cable System</td>\r\n                <td colspan=\"4\" style=\"border-left: hidden\">{{ doc.customer }}</td>\r\n            </tr>\r\n            <tr>\r\n                <td class=\"label_\" colspan=\"4\">\r\n                    <div class=\"row_\">\r\n                        <div class=\"label_\">Address </div>\r\n                        <!--<div>{{ doc.address_title or \"\" }}</div>-->\r\n                        <div>\r\n                        {%- if frappe.db.get_value(\"Address\", doc.address_title, \"address_line1\") is not none -%}\r\n                        :&nbsp;  {{ frappe.db.get_value(\"Address\", doc.address_title, \"address_line1\")}}\r\n                        {%- endif -%}\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td class=\"label_\">Tel No</td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"4\"> {{ doc.cable_system_address.replace(\"None\", \"\") | striptags if doc.cable_system_address else \"\"  }} </td>\r\n                <td class=\"label_\">Fax No</td>\r\n            </tr>\r\n            <tr rowspan=\"2\">\r\n                <td class=\"label_\" colspan=\"5\">Area Served</td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"5\" style=\"padding: 0 !important\">\r\n                    <table width=\"100%\">\r\n                        <tr>\r\n                            <td>\r\n                                <div class=\"column_\">\r\n                                    <div class=\"row_\" style=\"justify-content: flex-start;\">\r\n                                        <div>\r\n                                            <div><span class=\"label_\">Contract Start:</span> {{ [monthS + '.', dateS, yearS] | join(\" \") }}</div>\r\n                                        </div>\r\n                                        <div style=\"margin-left: 58px;\">\r\n                                            <div><span class=\"label_\">Contract End:</span> {{ [monthE + '.', dateE, yearE] | join(\" \") }}</div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <th class=\"text-center\" style=\"width: 230px\">Program(s)</th>\r\n                <th class=\"text-center\" style=\"width: 130px\">Start Date</th>\r\n                <th class=\"text-center\" style=\"width: 80px\">No of Subs</th>\r\n                <th class=\"text-center\" style=\"width: 80px\">Rate Per Subs</th>\r\n                <th class=\"text-center\">Monthly Billing</th>\r\n            </tr>\r\n            \r\n            {% for bill in bill_view %}\r\n            {% set month, date, year = frappe.format_date(bill.date_from).split(\" \") %}\r\n            <tr>\r\n                {% if loop.first %}\r\n                <td style=\"vertical-align:middle !important; text-align:center;\" rowspan={{ bill_view | len }}> {{ programs |map(attribute=\"subscription_program\")| list| unique |join(\", \") }}</td>\r\n                {% endif %}\r\n                {% set rate_sub = doc.programs | map(attribute=\"rate_per_sub\") | map('flt') | list | sum | flt(2) %}\r\n                <td class=\"text-center\">{{ [month + '.', date, year] | join(' ') }}</td>\r\n                <td class=\"text-center\">{{ \"---\" if doc.flat_fee == \"Yes\" else ((doc.monthly_subs_fee_total / 1.12) / rate_sub) | flt | round | int}}</td>\r\n                <!--<td class=\"text-center\">{{ \"---\" if doc.flat_fee == \"Yes\" else ((doc.monthly_subs_fee_total - (doc.monthly_subs_fee_total * 0.12)) / rate_sub) | int }}</td>-->\r\n                 <!--<td class=\"text-center\">{{ \"---\" if doc.flat_fee == \"Yes\" else frappe.db.get_list(\"PSOF Program\", {\"parent\": doc.name}, [\"subs_display\"], pluck=\"subs_display\") | sum }}</td>-->\r\n                <td class=\"text-center\">{{ \"---\" if doc.flat_fee == \"Yes\" else rate_sub }}</td>\r\n                <td class=\"text-center\">{{ frappe.utils.fmt_money(bill.total_fee if doc.flat_fee == \"Yes\" else doc.monthly_subs_fee_total\r\n                ,currency=\"$\") }}</td>\r\n            </tr> \r\n                {% if loop.last %}\r\n                <tr>\r\n                    <td colspan=3><b>Note: </b>VAT Inclusive</td>\r\n                    <td class=\"text-right\" style=\"border-left: hidden;\">TOTAL</td>\r\n                    <td class=\"text-center\">{{ frappe.utils.fmt_money(doc.monthly_subs_fee_total * (bill_view | len),currency=\"$\") }}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td colspan=5 style=\"padding: 0 !important;\">\r\n                        <div class=\"row_\">\r\n                            <div class=\"column_\" style=\"min-width: 230px; font-size: 9px; border-right: solid rgb(0 0 0) 1px;\">\r\n                                <div class=\"label_ text-left\">TERMS & CONDITIONS:</div>\r\n                                <ol type=1 class=\"terms\">\r\n                                    <li>All payments must be covered by postdated checks payable to <b>CABLE BOX OFFICE SHOWS AND SYSTEMS CORPORATION</b>.</li>\r\n                                    <li>Subscriber numbers shall be reviewed every six (6) months.</li>\r\n                                    <li>Unpaid subscription fee for over 30 days shall be subject to automatic cut-off of signal.</li>\r\n                                    <li>Security Deposit - 2 months for every channel.</li>\r\n                                    <li>Inclusive of VAT.</li>\r\n                                </ol>\r\n                            </div>\r\n                            <div class=\"column_ bottom_\" style=\"max-width: 200px; border-right: solid rgb(0 0 0) 1px;\">\r\n                                <div class=\"text-left-header\" style=\"font-size: 11px;\">SUBSCRIPTION RECOMMENDED BY:</div>\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-xs-12 text-center\">\r\n                                        <hr class=\"separator\" style=\"margin-top: 6px;\">\r\n                                        <div class=\"b_label\">SIGNATURE</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-xs-12 text-center\">\r\n                                        {{ doc.account_manager or ''}}\r\n                                        <hr class=\"separator\" style=\"margin-top: -4px;\">\r\n                                        <div class=\"b_label\" style=\"font-size: 12px;\">ACCOUNT MANAGER</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-xs-12 text-center\">\r\n                                        {{ frappe.utils.today() }}\r\n                                        <hr class=\"separator\" style=\"margin-top: -4px;\">\r\n                                        <div class=\"b_label\">DATE</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"column_ bottom_\" style=\"border-right: solid rgb(0 0 0) 1px;\">\r\n                                <div class=\"text-left-header\" style=\"font-size: 11px;\">SUBSCRIPTION AUTHORIZED BY:</div>\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-xs-12 text-center\">\r\n                                        <hr class=\"separator\" style=\"margin-top: 8px;\">\r\n                                        <div class=\"b_label\">SIGNATURE</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-xs-12 text-center\">\r\n                                        <hr class=\"separator\" style=\"margin-top: 15px;\">\r\n                                        <div class=\"b_label\">NAME</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"row\" >\r\n                                    <div class=\"col-xs-12 text-center\">\r\n                                        <hr class=\"separator\" style=\"margin-top: 15px;\">\r\n                                        <div class=\"b_label\" style=\"font-size: 12px;\">POSITION</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"column_ bottom_\" style=\"max-width: 131px; border-right: solid rgb(0 0 0) 1px;\">\r\n                                <div class=\"text-left-header\" style=\"font-size: 12px;\">APPROVED BY:</div>\r\n                                <div class=\"row\">\r\n                                    <div class=\"col-xs-12 text-center\">\r\n                                        <div style=\"font-size: 12px;\">EDRIC MICHAEL F. DY</div>\r\n                                        <hr class=\"separator\" style=\"margin-top: 3px;\">\r\n                                        <div class=\"b_label\">PRESIDENT </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n                {% endif %}\r\n            {% endfor %}\r\n        </table>\r\n        <div style=\"font-weight: bold;font-size: 20px;float: right;\">PSOF No. {{ doc.name }}</div>\r\n    </div>\r\n    <!--{% if doc.remarks %}-->\r\n    <!--<div style=\"font-size: 11px;\">-->\r\n    <!--    <div><b>Remarks:</b></div>-->\r\n    <!--    <div style=\"font-style: italic;\">{{ doc.remarks }}</div>-->\r\n    <!--</div>-->\r\n    <!--{% endif %}-->\r\n</div>\r\n\r\n\r\n",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2023-03-17 10:30:47.946360",
 "modified_by": "Administrator",
 "module": "Subscription",
 "name": "PSOF",
 "owner": "Administrator",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}