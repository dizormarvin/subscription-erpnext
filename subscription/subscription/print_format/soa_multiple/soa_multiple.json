{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2023-12-11 15:49:23.862854",
 "css": ".table-container {\n    display: flex; \n    flex-direction: row; \n    /*padding: 5px;*/\n    \n}\n\n.bottom-apart {\n    display: flex;\n    flex-flow: column;\n    justify-content: space-between;\n    /*min-height: 11.3in;*/\n    \n}\n\n.hr_apart {\n    display: flex;\n    flex-flow: column;\n    justify-content: space-between;\n    \n}\n\n.rnd-border {\n    border: 2px black solid;\n    border-radius: 15px;\n    background: ivory;\n    \n}\n\n.midtable-container {\n    display: flex;\n    flex-direction: row;\n    padding: 5px;\n    justify-content: space-around;\n    /*margin-top:-75px;*/\n    \n}\n\n.btm-border {\n    border-bottom: 1px solid black;\n}\n\n.row-apart {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    \n    \n  }\n  \n  .soa-container {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-evenly;\n    max-height: 10.5in;\n    min-height: 8in;\n    \n    \n  }\n  \n  .soa-container1 {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-evenly;\n    max-height: 10.5in;\n    min-height: 8in;\n    \n  }\n\n  .bold {\n    font-weight: bold;\n    font-size:13px;\n  }\n  \n.bottom-part {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    /*min-height: 11.3in;*/\n    \n}\n    \n    .soa-container > .table-container:nth-child(3) > table > tbody > tr > td:nth-child(n+2) {\n        text-align: right;\n        width: 100px;\n        \n        \n    }\n    \n#head {\n    /*margin-top: -40px;*/\n    display: flex;\n    column-gap: 40px;\n    \n}\n\n.column_ {\n    display: flex;\n    flex-direction: column;\n    \n}\n\n.bill-content {\n    display: flex;\n    gap: 10px;\n    \n}\n\n.label_ {\n    \n    display: flex;\n    font-weight: bold;\n    \n}\n\n\ntable{\n    \n    font-size:14px;\n    /*margin-bottom:100px; */\n    margin-bottom:40px;\n}\n\n\n\n\n.tg  {border-collapse:collapse;border-spacing:0; border:0;}\n.tg td{border-color:black;border-width:1px;font-family:Arial, sans-serif;font-size:14px;\n  overflow:hidden;padding:10px 5px;word-break:normal;text-align:right;}\n.tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;\n  font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}\n.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}\n.tg .tg-0lax{text-align:left;vertical-align:bottom}\n\n.msf-label {\n    padding-left: 5px !important;\n}\n\n.text-right {\n    text-align: right !important;\n}\n/*@page {*/\n/*  size: A4;*/\n  /*margin: 0;*/\n/*}*/\n\n.datetime {\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    display: flex;\n    justify-content: right;\n}\n\n.datetime table tr td {\n    font-size: 10px;\n    margin: 0px;\n    padding: 3px !important;\n}\n/*.datetime {*/\n/*    display: end;*/\n/*    justify-content: right;*/\n  \n/*}*/\n\n.margin-left-right {\n    margin-left:5%;\n    margin-right:5%;\n}\n\n\n\n.print-format tbody td {\n    vertical-align: bottom !important;\n}\n\n.print-format tbody .notesonly {\n    vertical-align: top !important;\n}\n\n\n\n\n.c1 {\n \n    width:60%;\n}\n\n.c2 {\n    flex:1;\n    text-align:right;\n}\n\n.c3 {\n    flex:1;\n    text-align:right;\n}\n\n.c4 {\n    flex:1;\n    text-align:right;\n}\n\n.c5 {\n    flex:1;\n    text-align:right;\n}",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 1,
 "doc_type": "Monthly PSOF Billing",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<div class=\\\"text-center\\\">\\t\\t\\t\\t\\n<h2>Statement of Account<br><small>{{ doc.name }}</small>\\t\\t\\t\\t</h2></div>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"<div class=\\\"soa-container\\\">\\n    {% for bill in doc.billings %} {% set subs_bill = frappe.db.get_list('Subscription Bill Item', {'parent': bill.bill_no, 'customer': bill.customer, 'bill_date': bill.date}, ['*']) %}\\n    <div class=\\\"row-apart\\\">\\n        <div>\\n            <div><b>Customer Name:</b> {{ bill.customer }}</div>\\n            <div><b>Customer Address:</b> CUSTOMER ADDRESS</div>\\n            <div><b>Contact Person:</b> </div>\\n        </div>\\n        <div>\\n            <div><b>Customer No:</b> {{ doc.monthly_psof }} </div>\\n            <div><b>Bill No:</b> {{ bill.bill_no }}</div>\\n            <div><b>Bill Date:</b> {{ frappe.format_date(bill.date) }}</div>\\n        </div>\\n    </div>\\n\\n    <div style=\\\"display: flex; flex-direction: column; padding: 5px\\\">\\n        <table style=\\\"align-self: center;\\\" border=1>\\n            <thead>\\n                <tr>\\n                    <td>SUBSCRIPTION PROGRAM</td>\\n                    <td>PSOF NO</td>\\n                </tr>\\n            </thead>\\n            {% for subs in subs_bill %}\\n            <tbody>\\n                <tr>\\n                    <td>{{ subs.subscription_program }}</td>\\n                    <td>{{ subs.psof_no}}</td>\\n                </tr>\\n            </tbody>\\n            {% endfor %}\\n        </table>\\n        {% set sub_totals = frappe.db.get_list('GL Entry', {'party':bill.customer, 'posting_date': ['<=', bill.date]}, ['sum(debit) as balance', 'sum(credit) as paid']) %}\\n        <table>\\n            <tr>\\n                <td>Balance as of {{ doc.subscription_period }}</td>\\n                <td>{{ frappe.format(sub_totals[0].balance, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n                <td>{{ frappe.format(sub_totals[0].paid, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n                <td>{{ frappe.format(sub_totals[0].balance - sub_totals[0].paid, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n            </tr>\\n            <tr>\\n                <td>{{ doc.subscription_period }}@{{ frappe.format(doc.exchange_rate, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n                <td>{{ frappe.format(bill.usd_msf_lv / 1.12, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n                <td></td>\\n                <td></td>\\n            </tr>\\n            <tr>\\n                <td>12%</td>\\n                <td>{{ frappe.format((bill.usd_msf_lv / 1.12) * 0.12, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n                <td></td>\\n                <td>{{ frappe.format(bill.usd_msf_lv, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n            </tr>\\n            <tr>\\n                <td>TOTAL</td>\\n                <td></td>\\n                <td></td>\\n                <td>{{ frappe.format((sub_totals[0].balance - sub_totals[0].paid) + bill.usd_msf_lv, { 'fieldtype': 'Currency', 'options': 'PHP' }) }}</td>\\n            </tr>\\n            {% if sub_totals[0].paid %}\\n            <tr>\\n                <td>Less Payment(s)</td>\\n            </tr>\\n            <tr>\\n                <td>\\n                    <table>\\n                        <tr>\\n                            <td>PAYMENT ENTRY</td>\\n                            <td>PAID AMOUNT</td>\\n                        </tr>\\n                    </table>\\n                </td>\\n            </tr>\\n            \\n            <tr>\\n                <td>Add(Deduct): Adjustments</td>\\n                <td>\\n                    <table>\\n                        <tr>\\n                            <td>Discounts</td>\\n                            <td>Amount</td>\\n                        </tr>\\n                    </table>\\n                </td>\\n                <td>Total adjustments</td>\\n            </tr>\\n            <tr>\\n                <td>TOTAL AMOUNT DUE & COLLECTIBLE AS OF MAY 2020</td>\\n                <td>CURRENCY</td>\\n                <td>AMOUNT DUE</td>\\n            </tr>\\n            <tr>\\n                <td>NOTE:</td>\\n                <td>\\n                    <table>\\n                        <tr>\\n                            <td>CHEQUE NO</td>\\n                            <td>CHEQUE AMOUNT in DOLLARS</td>\\n                        </tr>\\n                    </table>\\n                </td>\\n            </tr>\\n            {% endif %}\\n        </table>\\n        <div class=\\\"bottom-part\\\">\\n            <div>\\n                <div>Please Wire Transfer to:</div>\\n                <p>\\n                    <span class=\\\"bold\\\">Account Name:</span>OMNICONTENT MANAGEMENT, INC. <br>\\n                    <span class=\\\"bold\\\">Account Number (PESO):</span> C/A- 000-123-456-789 <br> \\n                    <span class=\\\"bold\\\">BANK NAME:</span>BANCO DE ORO (BDO)<br>\\n                    <span class=\\\"bold\\\">Branch:</span> HEAD OFFICE</p>\\n            </div>\\n            \\n            <div>\\n                <div>\\n                Please fax us a copy of your Deposit Slip @ Tel. Fax # (02) 910-32-96\\n                </div>\\n                <div class=\\\"row-apart\\\">\\n                    <div>{{ bill.date }} </div>\\n                    <div>SALES PERSON</div>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n    {% endfor %}\\n</div>\\n\\n<style>\\n    #table-container {\\n    \\n    }\\n    .row-apart {\\n        display: flex; \\n        flex-direction: row; \\n        justify-content: space-between;\\n    }\\n    .soa-container {\\n        display: flex;\\n        flex-direction: column;\\n    }\\n    \\n    .bold {\\n        font-weight: bold;\\n    }\\n    \\n    .bottom-part {\\n        display: flex;\\n        flex-direction: column;\\n        justify-content: space-between;\\n        min-height: 320px;\\n    }\\n</style>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"<div class=\\\"pagebreaks\\\"></div>\\n\\n\\n<style>\\n@media print {\\n    .pagebreaks {\\n        clear: both !important;\\n        page-break-after: always !important;\\n    }\\n}\\n</style>\\n\"}]",
 "html": "{% set current_month = frappe.get_doc(\"Subscription Period\", doc.subscription_period) %} \n{% set prev = current_month.start_date | string %} \n{% set cyear, cmonth, cday = prev.split(\"-\") %}\n{% set xyear, xmonth, xday = prev.split(\"-\") %}\n\n{% if ((cmonth | int) - 1) == 0 %} {% set cyear = ((cyear | int) - 1) | str %} \n    {% set cmonth = 12 | str %} \n{% endif %}\n\n{% if ((xmonth | int) - 1) == 0 %} \n    {% set xyear = ((xyear | int) - 1) | str %} \n    {% set xmonth = 12 | str %}\n{% else %}\n    {% set xyear = (xyear | int) | str %} \n    {% set xmonth = ((xmonth | int) - 1) | str %}\n{% endif %}\n\n{% set prev = [cyear, cmonth, cday] | join(\"-\") %} \n{% set xprev = [xyear, xmonth, xday] | join(\"-\") %}\n\n{% set m, d, y = frappe.format_date(prev).split(\" \") %} \n{% set xm, xd, xy = frappe.format_date(xprev).split(\" \") %}\n\n{% set bill_ff = \"\" %}\n{% set total_amount = 0 %} \n\n{% for bill in doc.billings %} \n{% set subs_bill = frappe.db.get_list('Subscription Bill Item', {'parent': bill.bill_no,'customer': bill.customer,'bill_date': bill.date}, ['*']) %}\n{% set tab_customer = frappe.db.sql(\"\"\"select  signatory from `tabCustomer` where name = %(cust)s\"\"\", {'cust': bill.customer}, as_dict=True) %}  \n{% set date_time = frappe.utils.now_datetime().strftime('%Y-%m-%d %H:%M:%S').split(' ') %}\n\n<!--<div class='datetime'>-->\n<!--    <table width='25%'>-->\n<!--        <tr>-->\n<!--            <td style=\"text-align: right; margin-right: 3px;\">-->\n<!--                Run Date:-->\n<!--            </td>-->\n<!--            <td>-->\n<!--                {{ date_time[0] }}-->\n<!--            </td>-->\n<!--        </tr>-->\n<!--        <tr>-->\n<!--            <td style=\"text-align: right; margin-right: 3px;\">-->\n<!--                Run Time:-->\n<!--            </td>-->\n<!--            <td>-->\n<!--                {{ date_time[1] }}-->\n<!--            </td>-->\n<!--        </tr>-->\n<!--    </table>-->\n<!--</div>-->\n\n\n<div class=\"margin-left-right\" id=\"head\" style='padding-top:-10px;'>\n        \n        <div style=\"height: auto;width: 135px;\"><img src=\"/files/cable boss logo.png\" /></div>\n        <div class=\"column_\" style=\"align-self: center; padding-left: 1px\">\n            <div class=\"text-center\" >\n                <b>CABLE BOX OFFICE SHOWS AND SYSTEMS CORPORATION</b><br>\n                6/F Renaissance Tower D, Meralco Avenue, Brgy. Ugong, Pasig City<br> \n                Tel.: 8633-7361 | 8633-6249 <br>\n                Fax: 8638-7588\n            </div>\n        </div>\n        \n        <!--<div class='datetime'><p>{{ frappe.utils.now_datetime().strftime('%Y-%m-%d %H:%M:%S') }}</p></div>-->\n        \n        \n    </div>\n\n<div class=\"bottom-part margin-left-right\">\n    <div class=\"soa-container1\">\n        <div class=\"text-center\" style=''>\n            <h2>Statement of Account<br /><small>{{ bill.customer }}</small></h2>\n        </div>\n            <div class=\"row-apart\">\n                <div>\n                    <div>{{ bill.customer_name }}</div>\n                    <div>{%- if frappe.db.get_value(\"Address\",  bill.customer + '-office', \"address_line1\") is not none -%}\n                \t\t{{ frappe.db.get_value(\"Address\",  bill.customer + '-office', \"address_line1\")}}\n                \t\t{%- endif -%}</div>\n                \t    {% if tab_customer %}\n                            <div>ATTENTION: {{ tab_customer[0].signatory or ' ' }}</div>\n                        {% endif %}\n                    \n                    <div class=\"bill-content\">\n                    \n                    \n                    \n                </div>\n                <br>\n            </div>\n            <div>\n                <div><b>No:</b> {{ bill.bill_no }}</div>\n                <div><b>Date:</b> {{ frappe.format_date(bill.billing_date) }}</div>\n            </div>\n        \n    </div>\n    <div class=\"table-container\" >\n        <div>To bill you for the following: &nbsp;</div>\n            <div class=\"label_\">\n            \n            {% for subs in subs_bill %}\n                \n                {{ subs.subscription_program  }}\n            {% endfor %}\n            \n            </div>\n    </div>\n    \n    {% set sub_totals = frappe.db.get_list('GL Entry', {'party':bill.customer,'posting_date': ['<', prev]}, [' sum(debit) as balance','sum(credit) as paid', 'voucher_no']) %}\n    <div class=\"midtable-container label_ rnd-border\" style='margin-top: 3px;'>\n        <div>PARTICULARS</div>\n        <div>AMOUNT</div>\n        \n        \n    </div>\n        <div class=\"table-container\">\n            \n<table class=\"tg margin-left-right\" width=100%>\n<tbody>\n  <tr>\n    <td class=\"tg-0lax bold\" colspan=\"2\">Balance as of {{ xm + \" \" + xy }}</td>\n    <td class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\"></td>\n    {% if sub_totals[0].paid %}\n        <td colspan=\"2\" class=\"tg-0lax\">Php</td>\n    {% else %}\n        <td colspan=\"2\" class=\"tg-0lax\"></td>\n    {% endif %}\n    <td class=\"tg-0lax text-right\">\n        {% if sub_totals[0].paid %}\n               {{ frappe.format(sub_totals[0].balance - sub_totals[0].paid, {'fieldtype':'Currency','options':'PHP' }) }}\n        {% else %}\n                \n        { frappe.format(sub_totals[0].balance, {'fieldtype':'Currency','options':'PHP' }) }}\n        {% endif %}\n    </td>\n  </tr>\n  <tr>\n    <!--<td class=\"tg-0lax\" colspan=\"2\">{{ doc.subscription_period }} @ {{ frappe.format(doc.exchange_rate, {'fieldtype':'Currency','options':'PHP' }) }}</td>-->\n     <td class=\"tg-0lax\" colspan=\"2\">{{ doc.subscription_period }} Subs Fee @ {{ doc.exchange_rate }}</td>\n     \n    \n    <td class=\"tg-0lax\">Php</td>\n    <td class=\"tg-0lax text-right\">{{ frappe.format(bill.usd_msf / 1.12, {'fieldtype':'Currency','options':'PHP' }) }}</td>\n    <td colspan=\"2\" class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\"></td>\n  </tr>\n  <tr>\n    <td class=\"tg-0lax\" colspan=\"2\">12% VAT</td>\n    <td class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax text-right\" style='border-bottom:1px solid black;'>{{ frappe.format(bill.usd_msf - (bill.usd_msf / 1.12), {'fieldtype':'Currency','options':'PHP' }) }}</td>\n    <td colspan=\"2\" class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax text-right\" style='border-bottom:1px solid black;'>{{ frappe.format(bill.usd_msf, {'fieldtype':'Currency','options':'PHP' }) }}</td>\n  </tr>\n  <tr>\n    <td class=\"tg-0lax\" colspan=\"2\">TOTAL</td>\n    <td class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\"></td>\n    <td colspan=\"2\" class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax text-right\">\n        {% if sub_totals[0].paid %}\n                {{ frappe.format(bill.usd_msf + (sub_totals[0].balance - sub_totals[0].paid), {'fieldtype':'Currency','options':'PHP' }) }}\n                {% set this_total = bill.usd_msf + (sub_totals[0].balance - sub_totals[0].paid) %}\n                \n                {% set total_amount = bill.usd_msf + (sub_totals[0].balance - sub_totals[0].paid) %}\n                \n                \n            {% else %}\n                {{ frappe.format(bill.usd_msf + (sub_totals[0].balance or 0), {'fieldtype':'Currency','options':'PHP' }) }}\n                {% set total_amount = bill.usd_msf + (sub_totals[0].balance or 0) %}\n            {% endif %}\n    </td>\n  </tr>\n   <!--\n   Direct Deposit - direct_deposit_date\n   Cash - pr_date\n   Check - reference_date\n   \n   \n   \n   -->\n   \n   \n  <tr>\n    <td class=\"tg-0lax\" colspan=\"2\">Less Payment(s)</td>\n    <td class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\"></td>\n    <td colspan=\"2\" class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\"></td>\n  </tr>\n  {% set less_payments = frappe.db.sql(\"\"\"\n            SELECT\n                name, pr_no, paid_amount, posting_date, mode_of_payment, pr_date, direct_deposit_date, reference_date, reference_no, cust_bank_acc, cable_boss_bank_account\n            FROM\n                `tabPayment Entry`\n            WHERE\n                party = %(customer)s AND docstatus = 1 and posting_date between %(start_date)s and %(end_date)s\n        \"\"\", {'customer': bill.customer, 'start_date': current_month.start_date, 'end_date': current_month.end_date}, as_dict=True) %}  \n            \n            \n{% for payment_entry in less_payments %}\n{% if payment_entry.reference_date %}\n    {% set pe_reference_date = payment_entry.reference_date.strftime('%Y-%m-%d') %}\n    {% set ref_date_parts = pe_reference_date.split('-') %}\n    {% set formatted_reference_date = ref_date_parts[1] + \"-\" + ref_date_parts[2] + \"-\" + ref_date_parts[0] %}\n{% endif %}\n{% if payment_entry.pr_date %}\n    {% set pe_pr_date = payment_entry.pr_date.strftime('%Y-%m-%d') %}\n    {% set pr_date_parts = pe_pr_date.split('-') %}\n    {% set formatted_pr_date = pr_date_parts[1] + \"-\" + pr_date_parts[2] + \"-\" + pr_date_parts[0] %}\n{% endif %}\n  <tr>\n    <td class=\"tg-0lax\" colspan=\"2\"> &nbsp; &nbsp; \n    {% if payment_entry.mode_of_payment == 'Check' or payment_entry.mode_of_payment == 'Check-USD' %}\n        PR # {{ payment_entry.pr_no }} / {{ payment_entry.cust_bank_acc.split(\"-\")[0] }} / {{ payment_entry.reference_no }} / {{ formatted_reference_date }}\n        \n    {% elif payment_entry.mode_of_payment == 'Cash' or payment_entry.mode_of_payment == 'Cash-USD (Conversion)' %}\n        PR # {{ payment_entry.pr_no }} / {{ payment_entry.mode_of_payment }} / {{ formatted_pr_date }}\n    {% elif payment_entry.mode_of_payment == 'Direct Deposit' or payment_entry.mode_of_payment == 'Direct Deposit-USD'%}\n        PR # {{ payment_entry.pr_no }}/ {{ payment_entry.cable_boss_bank_account.split('-')[0] }}  / {{ payment_entry.mode_of_payment }} / {{ formatted_pr_date }}\n    {% else %}\n        PR # {{ payment_entry.pr_no }} / {{ payment_entry.mode_of_payment }} / {{ payment_entry.direct_deposit_date }}\n    {% endif %}\n      </td>\n      <td class=\"tg-0lax\"></td>\n      \n     {% if loop.last %}\n        <td class=\"tg-0lax\" style=\"border-bottom:1px solid black;\" >{{ frappe.format( payment_entry.paid_amount , {'fieldtype':'Currency','options':'PHP' }) }} </td>\n    {% else %}\n        <td class=\"tg-0lax\"> {{ frappe.format( payment_entry.paid_amount , {'fieldtype':'Currency','options':'PHP' }) }} </td>\n    {% endif %}\n    <td colspan=\"2\"class=\"tg-0lax\"></td>\n    {% if loop.last %}\n    {% set totals_payment = frappe.db.get_list('Payment Entry', {'party':bill.customer,'posting_date': ['between', [current_month.start_date, current_month.end_date]], 'docstatus': 1}, [' sum(paid_amount) as paid_amount']) %}\n    <td colspan=2 class=\"tg-0lax text-right\" style=\"border-bottom:1px solid black;\" > {{ frappe.format( totals_payment[0].paid_amount , {'fieldtype':'Currency','options':'PHP' }) }} </td>\n    {% endif %}\n    \n  </tr>\n   {% endfor %}\n   \n   <tr>\n    <td class=\"tg-0lax\" colspan=\"2\">Add(Deduct): Adjustments</td>\n    <td class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\"></td>\n    <td  class=\"tg-0lax\"></td>\n  </tr>\n   \n  \n        {% set accounting_entries = frappe.db.sql(\"\"\" SELECT\n                    sum(jea.debit) as debit, sum(jea.credit) as credit, jea.parent, je.name as journal, je.posting_date, je.soa_remark_3, jea.party as customer,\n                    case\n                        when sum(jea.debit) = 0 then -sum(jea.credit)\n                        else sum(jea.debit)\n                    end as amount,\n                    \n                    case\n                        when sum(jea.debit) = 0 then 'credit'\n                        else 'debit'\n                    end as debit_credit\n                \n                FROM\n                    `tabJournal Entry Account` jea\n                LEFT JOIN\n                `tabJournal Entry` je ON je.name = jea.parent \n                \n                WHERE\n                jea.party = %(customer)s AND jea.docstatus = 1 \n                and je.naming_series in ('BILL-JV-.YYYY.-', 'BILL-JV-.YYYY.-.MM.-.####') and je.posting_date between %(start_date)s and %(end_date)s \n                and jea.account_type = %(like)s\n                group by je.name \"\"\",\n                {'customer': bill.customer, 'start_date': current_month.start_date, 'end_date': current_month.end_date, 'like': 'Receivable'}, as_dict=True)  %}\n        \n        \n        \n        {% for entry in accounting_entries %}\n        {% set posting_d = entry.posting_date | string %}\n        {% set cyear1, cmonth1, cday1 = posting_d.split(\"-\") %}\n        {% if ((cmonth1 | int) - 1) == 0 %}\n            {% set cyear1 = ((cyear1 | int) - 1) | str %}\n            {% set cmonth1 = 12 | str %}\n        {% endif %}\n        {% set posting_d1 = [cyear1, cmonth1, cday1] | join(\"-\") %}\n        {% set y1, d1, m1 = frappe.format_date(posting_d1).split(\" \") %}\n        \n        \n        {% set acc_ent = entry.amount|string %}\n        \n   \n  <tr>\n    <td class=\"tg-0lax\" colspan=\"2\" style='padding-left: 20px !important; '> {{ entry.soa_remark_3 }} </td>\n    <td class=\"tg-0lax\"></td>\n    {% if loop.last %}\n        <td class=\"tg-0lax text-right\" style=\"border-bottom:1px solid black;\">\n            {% if acc_ent.split('-')|len == 2  %}\n              ({{ frappe.format( acc_ent.split('-')[-1], {'fieldtype':'Currency','options':'PHP' }) }})\n                \n            {% else %}\n                {{ frappe.format( acc_ent.split('-')[-1], {'fieldtype':'Currency','options':'PHP' }) }}\n            {% endif %}\n        </td>\n    {% else %}\n        {% if acc_ent.split('-')|len == 2  %}\n          <td class=\"tg-0lax text-right\" >({{ frappe.format( acc_ent.split('-')[-1], {'fieldtype':'Currency','options':'PHP' }) }}) </td>\n            \n        {% else %}\n            <td class=\"tg-0lax text-right\" >{{ frappe.format( acc_ent.split('-')[-1], {'fieldtype':'Currency','options':'PHP' }) }} </td>\n        {% endif %}\n        \n    {% endif %}\n    <td colspan=2 class=\"tg-0lax\"></td>\n     {% set account_entries = frappe.db.sql(\"\"\"\n                SELECT\n                jea.parent, je.name as journal, je.posting_date, je.soa_remark_3, jea.party as customer,\n                sum(\n                case\n                when jea.debit = 0 then -jea.credit\n                else jea.debit\n                end\n                ) as amount,\n                \n                case\n                when sum(jea.debit) = 0 then 'credit'\n                else 'debit'\n                end as debit_credit\n                \n                FROM\n                `tabJournal Entry Account` jea\n                LEFT JOIN\n                `tabJournal Entry` je ON je.name = jea.parent \n                WHERE\n                jea.party = %(customer)s AND jea.docstatus = 1 and je.naming_series in ('BILL-JV-.YYYY.-', 'BILL-JV-.YYYY.-.MM.-.####') and je.posting_date between %(start_date)s and %(end_date)s and jea.account_type = %(like)s\n            \n                \"\"\", \n            {'customer': bill.customer, 'start_date': current_month.start_date, 'end_date': current_month.end_date, 'like': 'Receivable'}, as_dict=True) \n            %}\n                {% set sum_total_adjustment = [] %}\n                {% if loop.last %}\n                \n                {% set totals_payment = frappe.db.get_list('Payment Entry', {'party':bill.customer,'posting_date': ['between', [current_month.start_date, current_month.end_date]], 'docstatus': 1}, [' sum(paid_amount) as paid_amount']) %}\n                {% set acc_ent = account_entries[0].amount|string %}\n                \n                    {% if acc_ent.split('-')|len == 2 %}\n                        <td class=\"tg-0lax text-right\" style=\"border-bottom:1px solid black;\">({{ frappe.format( -1 * account_entries[0].amount, {'fieldtype':'Currency','options':'PHP' }) }})</td>\n                    {% else %}\n                        <td class=\"tg-0lax text-right\" style=\"border-bottom:1px solid black;\">{{ frappe.format( account_entries[0].amount, {'fieldtype':'Currency','options':'PHP' }) }}</td>\n                    {% endif %}\n                {% endif %}\n  </tr>\n  \n   {% endfor %}\n   \n   <tr>\n         <td class=\"tg-0lax\" colspan=\"2\" style=\"font-weight:bold; font-size:12px;\">TOTAL AMOUNT DUE & COLLECTIBLE AS OF {{ m.upper() + \" \" + y }}</td>\n    <td class=\"tg-0lax\"></td>\n    <td class=\"tg-0lax\" style='color:white;'></td>\n    <td colspan=2 class=\"tg-0lax\" style=\"font-weight:bold\">Php</td>\n          \n          {% set total_amount_due = [] %}\n                {% set totals_subs = frappe.db.get_list('GL Entry', {'party':bill.customer,'posting_date': ['<', prev]}, [' sum(debit) as balance','sum(credit) as paid', 'voucher_no']) %}\n                {% set totals_payment = frappe.db.get_list('Payment Entry', {'party':bill.customer,'posting_date': ['between', [current_month.start_date, current_month.end_date]], 'docstatus': 1}, [' sum(paid_amount) as paid_amount']) %}\n                \n                <!--journal entry-->\n                {% set account_entries = frappe.db.sql(\"\"\"\n                    SELECT\n                        jea.parent, je.name as journal, je.posting_date, je.soa_remark_3, jea.party as customer,\n                        sum(\n                            case\n                                when jea.debit = 0 then -jea.credit\n                            else jea.debit\n                            end\n                        ) as amount,\n                    \n                        case\n                            when sum(jea.debit) = 0 then 'credit'\n                        else 'debit'\n                        end as debit_credit\n                    \n                    FROM\n                        `tabJournal Entry Account` jea\n                    LEFT JOIN\n                        `tabJournal Entry` je ON je.name = jea.parent \n                    WHERE\n                        jea.party = %(customer)s AND jea.docstatus = 1 and je.naming_series in ('BILL-JV-.YYYY.-', 'BILL-JV-.YYYY.-.MM.-.####') and je.posting_date between %(start_date)s and %(end_date)s and jea.account_type LIKE %(like)s\n                \n                \"\"\", \n                {'customer': bill.customer, 'start_date': current_month.start_date, 'end_date': current_month.end_date, 'like': 'Receivable'}, as_dict=True) \n                %}\n                \n                {% set _ = total_amount_due.append((total_amount or 0) - (totals_payment[0].paid_amount or 0)) %}\n                {% set _ = total_amount_due.append(account_entries[0].amount or 0) %}\n                \n                \n                <td class=\"c5 btm-border text-right\" style=\"border-bottom:double; font-weight:bold\">{{ frappe.format(total_amount_due|sum, {'fieldtype':'Currency','options':'PHP' }) }}</td>\n   </tr>\n     <tr></tr>\n   <tr>\n    <td class=\"tg-0pky\" colspan=\"2\"></td>\n    <td class=\"tg-0pky\"></td>\n    <td class=\"tg-0pky\"></td>\n    <td class=\"tg-0pky\"></td>\n  </tr>\n  \n\n  \n  <!-- <tr>-->\n  <!--  <td width='50%' class=\"tg-0lax\" colspan=\"\">NOTE: </td>-->\n \n  <!--  <td width='50%' class=\"text-left\" style='margin-right:200px; text-align:left;'>-->\n  <!--      <table style='margin-left:-5px; margin-top:-5px; text-align:right; font-size:13px;'>-->\n  <!--          {% set note_subs_bill = frappe.db.get_list('Subscription Bill Item', {'parent': bill.bill_no,'customer': bill.customer,'bill_date': bill.date}, ['*'], group_by='psof_no') %}-->\n            \n            <!--start loop note_subs_bill-->\n  <!--          {% for subs in note_subs_bill %}-->\n  <!--              {% set psof_programs = frappe.db.get_list('PSOF Program', {'parent': subs.psof_no}, ['sum(subscription_fee) as subs_fee']) %}-->\n                \n                <!--start loop psof_programs-->\n  <!--              {% for psof_program in psof_programs %}-->\n  <!--                  <tr>-->\n  <!--                      <td> -->\n  <!--                          {{ subs.psof_no  }} Subs Fee @ $ &nbsp; {{ frappe.format( psof_program.subs_fee  , {'fieldtype':'Currency','options':'PHP' }) }}-->\n  <!--                      </td>-->\n  <!--                  </tr>-->\n  <!--              {% endfor %}-->\n                <!--end loop psof_programs-->\n                \n  <!--          {% endfor %}-->\n            \n            <!--end loop note_subs_bill-->\n  <!--      </table>-->\n  <!--  </td>-->\n  <!--</tr>-->\n  \n  <tr>\n    <td width='8%' class=\"notesonly\" colspan=\"\">NOTE: </td>\n \n    <td width='50%' class=\"text-left\" style='margin-right:200px; text-align:left;'>\n        <table style='margin-left:-5px; margin-top:-5px; text-align:right; font-size:13px;'>\n                    {% set note_subs_bill = frappe.db.get_list('Subscription Bill Item', {'parent': bill.bill_no,'customer': bill.customer,'bill_date': bill.date}, ['*'], group_by='psof_no') %}\n                    \n                    <!--start loop note_subs_bill-->\n                    {% for subs in note_subs_bill %}\n                        {% set psof_programs = frappe.db.get_list('PSOF Program', {'parent': subs.psof_no}, ['sum(subscription_fee) as subs_fee']) %}\n                        \n                        <!--start loop psof_programs-->\n                        {% for psof_program in psof_programs %}\n                            <tr>\n                                <td> \n                                    {{ subs.psof_no  }} @ $ &nbsp; {{ frappe.format( psof_program.subs_fee  , {'fieldtype':'Currency','options':'PHP' }) }}\n                                </td>\n                            </tr>\n                        {% endfor %}\n                        <!--end loop psof_programs-->\n                        \n                    {% endfor %}\n                    \n                    <!--end loop note_subs_bill-->\n                </table>\n    </td>\n  </tr>\n \n</tbody>\n</table>\n\n        \n    </div>\n    </div>\n\n    \n      <!--<div>-->\n      <!--  <div>Please Wire Transfer to:</div>-->\n      <!--  <p>-->\n      <!--    <span class=\"bold\">Account Name:</span>OMNICONTENT MANAGEMENT, INC.-->\n      <!--    <br />-->\n      <!--    <span class=\"bold\">Account Number (PESO):</span> C/A- 000-123-456-789-->\n      <!--    <br />-->\n      <!--    <span class=\"bold\">BANK NAME:</span>BANCO DE ORO (BDO)<br />-->\n      <!--    <span class=\"bold\">Branch:</span> HEAD OFFICE-->\n      <!--  </p>-->\n      <!--</div>-->\n\n      <!--<div style='position:fixed; bottom:0;'>-->\n      \n    <div style='bottom: 100;'>\n    <div class=\"container\" style=\"width: 100% !important; padding: 0 !important; margin: 0 !important;\">\n        <div class=\"row row-apart\" style=\"padding: 0 !important; margin: 0 !important; width: 100% !important;\">\n            <div class=\"col-xs-12\" style=\"padding: 0 !important; margin: 0 !important;\">\n                <div style=\"width: 100%; font-size: 12px; color:white;\">\n                    NOTE: Payment of the check should be made payable to CABLE BOX OFFICE SHOWS & SYSTEMS CORPORATION.\n                </div>\n            </div>\n        </div>\n        <div class=\"row\" style=\"padding: 0 !important; margin: 0 !important; width: 100% !important;\">\n            <div class=\"col-xs-6\" style=\"padding: 0 !important; margin: 0 !important;\">\n                <div style=\"width: 100%; font-size: 12px;\">\n                    <div class=\"rnd-border\">\n                        <div class=\"bold\" style=\"margin-left: 10px\">Note:</div>\n                        <ol style=\"font-size:9px\">\n                            <li>Please disregard this notice if payment has already been made</li>\n                            <li>Payment of the check should be made payable to CABLE BOX OFFICE SHOWS & SYSTEMS CORPORATION.</li>\n                            <li>This will be considered correct unless notification to the contrary is received within Ten (10) days from receipt hereof.</li>\n                            <li>Unsettled subscription fee within 30 days from receipt hereof will result in deactivation of signal.</li>\n                        </ol>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"col-xs-6\" style=\"padding: 0 !important; margin: 0 !important;\">\n                <div style=\"width: 100%; font-size: 12px;\">\n                        <div class=\"rnd-border text-center hr_apart\" style=\"margin-left: 5px; font-size: 12px\">\n                            <div class=\"bold\">\n                                <div style='font-size: 12px !important;'>CABLE BOX OFFICE SHOWS & SYSTEMS CORPORATION</div>\n                                <div style='font-size: 13px !important;'>One great source. All great networks.</div>\n                            </div>\n                            <div><br><br><br></div>\n                            <div>\n                                                                <!--<div class=\"btm-border\" style=\" margin: auto;\">{{ frappe.db.get_value(\"Customer\",  bill.customer, 'billing_assistant') }}</div>-->\n\n                                <div class=\"\" style=\" margin: auto;\">{{ frappe.db.get_value(\"Customer\",  bill.customer, 'billing_assistant') or '<br>' }}</div>\n                                <div style=\"text-decoration: overline\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Contact Person &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n    </div>\n    </div>\n</div>\n   \n      \n      <!--ORIGINAL-->\n      <!--<div style=' bottom:100;'>-->\n      <!--  <div class=\"btm-border\" style=\"font-size: 12px; color:white;\">-->\n      <!--    NOTE : Payment of check should be made payable to CABLE BOX OFFICE SHOWS & SYSTEMS CORPORATION.-->\n      <!--  </div>-->\n      <!--  <div style=\"margin-top: 0px; \" >-->\n      <!--  <div class=\"row-apart\">-->\n      <!--    <div class=\"rnd-border\">-->\n              \n      <!--        <ol style=\"font-size:9px\">-->\n      <!--            <div class=\"bold\" style=\"margin-left: 10px\">Note:</div>-->\n      <!--            <li>Please disregard this notice if payment has already been made</li>-->\n      <!--            <li>Payment of check should be made payable to CABLE BOX OFFICE SHOWS & SYSTEMS CORPORATION.</li>-->\n      <!--            <li>This will be considered correct unless notifacation to the contrary is received within Ten (10) days from receipt hereof.</li>-->\n      <!--            <li>Unsettled subscription fee within 30 days from receipt hereof will result in deactivation of signal.</li>-->\n      <!--        </ol>-->\n      <!--    </div>-->\n      <!--    <div class=\"rnd-border text-center hr_apart\" style=\"margin-left: 5px; font-size: 12px\">-->\n      <!--        <div class=\"bold\">-->\n      <!--            <div style='font-size: 12px !important;'>CABLE BOX OFFICE SHOWS & SYSTEMS CORPORATION</div>-->\n      <!--            <div>One great source. All great networks.</div>-->\n      <!--        </div>-->\n      <!--        <div>-->\n      <!--            <div class=\"btm-border\" style=\"width: 100px;  margin: auto;\">{{ frappe.db.get_value(\"Customer\",  bill.customer, 'billing_assistant') }}</div>-->\n      <!--            <div>Contact Person</div>-->\n      <!--        </div>-->\n      <!--    </div>-->\n      <!--  </div>-->\n      <!--  </div>-->\n      <!--</div>-->\n  \n<div class=\"page-break\"></div>\n\n\n{% endfor %}\n\n\n\n\n\n\n",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2024-05-13 13:22:48.981740",
 "modified_by": "Administrator",
 "module": "Subscription",
 "name": "Soa Multiple",
 "owner": "Administrator",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}